#:kivy 2.3.0
#:import Factory kivy.factory.Factory
#TODO: fix line borders being buggy and dissapearing when scaling the menu

<Mybutton>:
    canvas.after:
        Color:
            rgba: (1, 1, 1, 1)
        Line:
            rectangle: self.x, self.y, self.width, self.height + 1
    background_normal:""
    background_down: ""
    background_color: (0, 0, 0, 1)

<TextInput>:
    cursor_color: (1, 1, 1, 1)
    foreground_color: (1, 1, 1, 1)
    background_color: (0, 0, 0, 1)
    background_normal:""
    selection_color: (1, 0, 0, 0.2)

<QuitPopup@Popup>:
    title: "[ ! ] Alert"
    size_hint: 0.5, 0.5
    background_normal:""
    background_color: (0, 0, 0, 1)
    foreground_color: (1, 1, 1, 1)
    separator_color: (1, 0, 0, 1)
    StackLayout:
        spacing: 28  # between Buttons
        Label:
            canvas.before:
                Color:
                    rgba: (1, 1, 1, 1)
                Line:
                    rectangle: self.x, self.y, self.width, self.height + 1
            text: "Are you sure you want to close the program? \n(all unsaved changes will be lost)"
            size_hint:1,.8
        Button:
            text: "Yes"
            size_hint:.5,.2
            on_release: app.stop()
        
        Button:
            text: "Cancel"
            size_hint:.5,.2
            on_release: root.dismiss()


<MainScreen>:
    text: text
    StackLayout:
        Mybutton:
            text:"⚙"
            font_size: root.height/20
            font_name: "DejaVuSans.ttf"
            size_hint:.03,.05
            on_press:
                root.manager.transition.direction = 'left'
                root.manager.current = 'Settings'
        Mybutton:
            text:"[u]S[/u]ave"
            markup:True
            size_hint:.1,.05
            on_press: root.save_file()
        Mybutton:
            text:"[u]O[/u]pen"
            markup:True
            size_hint:.1,.05
            on_press: root.open_file()
        Mybutton:
            text:"Open file"
            size_hint:.1,.05
            on_press: root.open_directory()
        Mybutton:
            text:"Save as"
            size_hint:.1,.05
            on_press: root.save_as_file()
        Mybutton:
            text:"[u]Q[/u]uit"
            markup:True
            size_hint:.1,.05
            on_press: Factory.QuitPopup().open()
        TextInput:
            id:text
            auto_indent:True
            focus:True
            size_hint:1.0,.85
        TextInput:
            canvas.before:
                Color:
                    rgba: (1, 1, 1, 1)
                Line:
                    rectangle: self.x, self.y, self.width, self.height
            id: filename_input
            text: "No file currently open"
            multiline: False
            on_text_validate: root.rename_file()
            size_hint:.5,.05
        TextInput:
            canvas.before:
                Color:
                    rgba: (1, 1, 1, 1)
                Line:
                    rectangle: self.x, self.y, self.width, self.height
            id: directory_label
            text: "No open directory"
            readonly: True
            size_hint:.5,.05
        Label:
            id: info_label
            text: "..."
            text_size: self.size
            halign: "left"
            valign: "center"
            size_hint:1,.05

<SettingsScreen>:
    StackLayout:
        Mybutton:
            text: '←'
            font_size: root.height/20
            font_name: "DejaVuSans.ttf"
            size_hint:.03,.05
            on_press: 
                root.manager.transition.direction = 'right'
                root.manager.current = 'Main'
        Label:
            canvas.before:
                Color:
                    rgba: (1, 1, 1, 1)
                Line:
                    rectangle: self.x, self.y, self.width, self.height
            text: "Settings"
            font_size: root.height/30
            size_hint:0.97,.05
        TabbedPanel:
            size_hint:1,0.95
            do_default_tab: False
            TabbedPanelItem:
                text: "General"
                StackLayout:
                    Label:
                        text: "AAAAAAA"
            TabbedPanelItem:
                text: "Visuals"
            TabbedPanelItem:
                text: "More stuff"


<RootScreenManager>:
    size: root.width, root.height
    MainScreen:
        id: mainscreen
        name: "Main"
    SettingsScreen:
        id: settingsscreen
        name: "Settings"
